<!-- MDBootstrap Datatables  -->
<script type="text/javascript" src="/js/addons/datatables.min.js"></script>
<div class="p-5">
    <table id="RegistrationsTable" class="table table-striped table-bordered table-responsive-md table-sm"
        cellspacing="0" width="100%">
        <thead>
            <tr>
                <th class="th-sm">Name
                </th>
                <th class="th-sm">Email
                </th>
                <th class="th-sm">Phone Number
                </th>
                <th class="th-sm">Event name
                </th>
                <th class="th-sm">Remove
                </th>
            </tr>
        </thead>
        <tbody>
            {{#each registrations}}
            <tr id="{{_id}}">
                <td>{{name}}</td>
                <td>{{email}}</td>
                <td>{{phoneNumber}}</td>
                <td>{{eventName}}</td>
                <td><a onclick="RemoveRegistration('{{_id}}','{{name}}')" href="#"><i class="fas fa-trash-alt"></i>
                        Remove</a>
                </td>
            </tr>
            {{/each}}
        </tbody>
    </table>
</div>
<script>
    $('#RegistrationsTable').DataTable({
        "ordering": false // false to disable sorting (or any other option)
    });

    function RemoveRegistration(id, name) {
        $.post(`/admin/registrations/delete/${id}?_method=DELETE`, { name: name }, (data, status, query) => {
            console.log("Removed " + data);
            $(`#${id}`).remove();

            let alert = document.createElement("div");
            alert.classList = "alert alert-success alert-dismissible position-fixed text-center fade show";
            alert.setAttribute("role", "alert");
            alert.setAttribute("style", "top:65px;left:50%;transform: translateX(-50%);");
            alert.innerHTML = `<strong>${data}</strong> registration has been removed!
                    <button type = "button" class="close" data-dismiss="alert" aria-label="Close">
                    <span aria-hidden="true">&times;</span></button>`;
            $("body").append(alert);

            setTimeout(() => {
                $(alert).remove();
            }, 2000);
            /*
            $("body").append(`<div class="alert alert-success alert-dismissible position-fixed text-center fade show" role="alert" style="top:65px;margin:0 auto;">
                    <strong>${data}</strong> registration has been removed!
                    <button type = "button" class="close" data-dismiss="alert" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                    </button>
                    </div>`);*/

        })
    }

    function removeElement(element) {
        $(element).remove();
    }


</script>